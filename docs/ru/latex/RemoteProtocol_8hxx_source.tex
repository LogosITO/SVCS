\doxysection{Remote\+Protocol.\+hxx}
\hypertarget{RemoteProtocol_8hxx_source}{}\label{RemoteProtocol_8hxx_source}\index{server/include/RemoteProtocol.hxx@{server/include/RemoteProtocol.hxx}}
\mbox{\hyperlink{RemoteProtocol_8hxx}{См. документацию.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ISubject_8hxx}{../../services/ISubject.hxx}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{RepositoryManager_8hxx}{../../core/include/RepositoryManager.hxx}}"{}}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ <unordered\_set>}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacesvcs_1_1server}{svcs::server}}\ \{}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespacesvcs_1_1core}{svcs::core}};}
\DoxyCodeLine{00050\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespacesvcs_1_1services}{svcs::services}};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00067\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classsvcs_1_1server_1_1RemoteProtocol_a48c7eccea0dcfbd3f38ebaacc890716c}{RemoteProtocol}}\ \{}
\DoxyCodeLine{00068\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{classsvcs_1_1server_1_1RemoteProtocol_a48c7eccea0dcfbd3f38ebaacc890716c}{RemoteProtocol}}(std::shared\_ptr<ISubject>\ event\_bus,}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::shared\_ptr<RepositoryManager>\ repository\_manager);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00090\ \ \ \ \ \mbox{\hyperlink{classsvcs_1_1server_1_1RemoteProtocol_a82e9f15545647e6f9f6a67fd4e2c7c85}{\string~RemoteProtocol}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classsvcs_1_1server_1_1RemoteProtocol_ac59264cdc26ec33dc6699c6d745c2433}{handleReceivePack}}();}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classsvcs_1_1server_1_1RemoteProtocol_ab6ad22411376351076b3e58c5d5d2e6a}{handleUploadPack}}();}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{comment}{//\ Receive-\/pack\ (Push)\ Protocol\ Methods}}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordtype}{bool}\ processPushNegotiation();}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordtype}{bool}\ receiveObjects(\textcolor{keyword}{const}\ std::unordered\_set<std::string>\&\ wanted\_objects);}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordtype}{bool}\ updateReferences(\textcolor{keyword}{const}\ std::vector<std::pair<std::string,\ std::string>>\&\ ref\_updates);}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{comment}{//\ Upload-\/pack\ (Pull)\ Protocol\ Methods}}
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keywordtype}{bool}\ processPullNegotiation();}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00188\ \ \ \ \ std::unordered\_set<std::string>\ findMissingObjects(\textcolor{keyword}{const}\ std::unordered\_set<std::string>\&\ client\_has);}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordtype}{bool}\ sendObjects(\textcolor{keyword}{const}\ std::unordered\_set<std::string>\&\ objects\_to\_send);}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{comment}{//\ Object\ and\ Reference\ Management\ Methods}}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keywordtype}{bool}\ objectExists(\textcolor{keyword}{const}\ std::string\&\ object\_hash)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00228\ \ \ \ \ std::string\ readObject(\textcolor{keyword}{const}\ std::string\&\ object\_hash)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00243\ \ \ \ \ \textcolor{keywordtype}{bool}\ writeObject(\textcolor{keyword}{const}\ std::string\&\ object\_hash,\ \textcolor{keyword}{const}\ std::string\&\ object\_data);}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00254\ \ \ \ \ std::unordered\_set<std::string>\ getAllReferences()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordtype}{bool}\ updateReference(\textcolor{keyword}{const}\ std::string\&\ ref\_name,\ \textcolor{keyword}{const}\ std::string\&\ new\_hash);}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{comment}{//\ Protocol\ Communication\ Methods}}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{keywordtype}{bool}\ readLine(std::string\&\ line)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{keywordtype}{bool}\ sendLine(\textcolor{keyword}{const}\ std::string\&\ line)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keywordtype}{bool}\ sendData(\textcolor{keyword}{const}\ std::string\&\ data)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{keywordtype}{bool}\ sendError(\textcolor{keyword}{const}\ std::string\&\ error)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{comment}{//\ Validation\ Methods}}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keywordtype}{bool}\ isValidObjectHash(\textcolor{keyword}{const}\ std::string\&\ hash)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00353\ \ \ \ \ \textcolor{keywordtype}{bool}\ isValidReference(\textcolor{keyword}{const}\ std::string\&\ ref\_name)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{comment}{//\ Notification\ Methods}}
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyDebug(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00376\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyInfo(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyError(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyProtocolStart(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyProtocolSuccess(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyProtocolError(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyNetworkSend(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyNetworkReceive(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyObjectTransfer(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyReferenceUpdate(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00475\ \ \ \ \ \textcolor{keywordtype}{void}\ notifyNegotiation(\textcolor{keyword}{const}\ std::string\&\ message)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keywordtype}{bool}\ sendProtocolError(\textcolor{keyword}{const}\ std::string\&\ error)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00500\ \ \ \ \ std::shared\_ptr<ISubject>\ event\_bus\_;}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00509\ \ \ \ \ std::shared\_ptr<RepositoryManager>\ repository\_manager\_;}
\DoxyCodeLine{00510\ \};}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \}}

\end{DoxyCode}
