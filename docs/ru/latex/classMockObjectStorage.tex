\doxysection{Класс Mock\+Object\+Storage}
\hypertarget{classMockObjectStorage}{}\label{classMockObjectStorage}\index{MockObjectStorage@{MockObjectStorage}}


Mock implementation of \doxylink{classObjectStorage}{Object\+Storage}.  


Граф наследования\+:Mock\+Object\+Storage\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classMockObjectStorage}
\end{center}
\end{figure}
\doxysubsubsection*{Открытые члены}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classMockObjectStorage_a435d599ef47054afe225443e60a933a9}\label{classMockObjectStorage_a435d599ef47054afe225443e60a933a9} 
{\bfseries Mock\+Object\+Storage} (const fs\+::path \&temp\+\_\+dir)
\item 
bool \mbox{\hyperlink{classMockObjectStorage_a0d17e41ae6b3787ed45aad9b75ea0518}{save\+Object}} (const \mbox{\hyperlink{classVcsObject}{Vcs\+Object}} \&object) const override
\begin{DoxyCompactList}\small\item\em Сохраняет \doxylink{classVcsObject}{Vcs\+Object} в базе данных объектов. \end{DoxyCompactList}\item 
std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classVcsObject}{Vcs\+Object}} $>$ \mbox{\hyperlink{classMockObjectStorage_a6710861deb4109e3c4a716ac9b38fe66}{load\+Object}} (const std\+::string \&hash) const override
\begin{DoxyCompactList}\small\item\em Загружает объект с диска по его ID хеша. \end{DoxyCompactList}\item 
\Hypertarget{classMockObjectStorage_a0c6859b204e1e089a2ddefd0963f403a}\label{classMockObjectStorage_a0c6859b204e1e089a2ddefd0963f403a} 
void {\bfseries clear} ()
\item 
\Hypertarget{classMockObjectStorage_a9ae69ebb59854a8e1d17e03f3d6361d6}\label{classMockObjectStorage_a9ae69ebb59854a8e1d17e03f3d6361d6} 
bool {\bfseries is\+\_\+blob\+\_\+saved} (const std\+::string \&hash) const
\item 
\Hypertarget{classMockObjectStorage_abd3dd66b1873d619fa6ee4965882de48}\label{classMockObjectStorage_abd3dd66b1873d619fa6ee4965882de48} 
size\+\_\+t {\bfseries get\+\_\+saved\+\_\+blobs\+\_\+count} () const
\end{DoxyCompactItemize}
\doxysubsection*{Открытые члены унаследованные от \mbox{\hyperlink{classObjectStorage}{Object\+Storage}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classObjectStorage_a97cd1089e57caec02d91e9d5177f2607}{Object\+Storage}} (const std\+::string \&root\+\_\+path, const std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classISubject}{ISubject}} $>$ \&subject=nullptr)
\begin{DoxyCompactList}\small\item\em Конструктор для \doxylink{classObjectStorage}{Object\+Storage}. \end{DoxyCompactList}\item 
virtual {\bfseries \texorpdfstring{$\sim$}{\string~}\+Object\+Storage} ()
\begin{DoxyCompactList}\small\item\em Деструктор. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classObjectStorage_a0dc7bb15cb48b9795149e3572c4c7c3c}{set\+Subject}} (std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classISubject}{ISubject}} $>$ subj)
\begin{DoxyCompactList}\small\item\em Устанавливает или заменяет субъект событий, используемый \doxylink{classObjectStorage}{Object\+Storage}. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{classObjectStorage_a3bdb2110012cbe733cdeb4d438b583d0}{get\+Object\+Path}} (const std\+::string \&hash) const
\begin{DoxyCompactList}\small\item\em Формирует полный путь в файловой системе для объекта на основе его хеша. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classObjectStorage_abbc8d8426ae0f500aa7a6dba213e0bed}{object\+Exists}} (const std\+::string \&hash) const
\begin{DoxyCompactList}\small\item\em Проверяет, существует ли объект с заданным хешем на диске. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Открытые атрибуты}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classMockObjectStorage_a5b9d03f4ac4ee12bd8ae53b23122b04c}\label{classMockObjectStorage_a5b9d03f4ac4ee12bd8ae53b23122b04c} 
std\+::map$<$ std\+::string, std\+::string $>$ {\bfseries saved\+\_\+blobs}
\end{DoxyCompactItemize}


\doxysubsection{Подробное описание}
Mock implementation of \doxylink{classObjectStorage}{Object\+Storage}. 


\begin{DoxyItemize}
\item This mock substitutes the actual filesystem I/O for object saving and loading with an in-\/memory map, allowing for fast, isolated testing of the \doxylink{classIndex}{Index}\textquotesingle{}s interaction with the storage layer. 
\end{DoxyItemize}

\label{doc-func-members}
\Hypertarget{classMockObjectStorage_doc-func-members}
\doxysubsection{Методы}
\Hypertarget{classMockObjectStorage_a6710861deb4109e3c4a716ac9b38fe66}\index{MockObjectStorage@{MockObjectStorage}!loadObject@{loadObject}}
\index{loadObject@{loadObject}!MockObjectStorage@{MockObjectStorage}}
\doxysubsubsection{\texorpdfstring{loadObject()}{loadObject()}}
{\footnotesize\ttfamily \label{classMockObjectStorage_a6710861deb4109e3c4a716ac9b38fe66} 
std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classVcsObject}{Vcs\+Object}} $>$ Mock\+Object\+Storage\+::load\+Object (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{hash}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Загружает объект с диска по его ID хеша. 

Читает сжатый файл, распаковывает его, выполняет проверки целостности и десериализует объект с использованием внутреннего фабричного метода. 
\begin{DoxyParams}{Аргументы}
{\em hash} & ID хеша объекта для загрузки. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Возвращает}
std\+::unique\+\_\+ptr$<$\+Vcs\+Object$>$ Восстановленный экземпляр объекта. 
\end{DoxyReturn}

\begin{DoxyExceptions}{Исключения}
{\em std\+::runtime\+\_\+error} & если объект не найден, поврежден или недействителен. \\
\hline
\end{DoxyExceptions}


Переопределяет метод предка \mbox{\hyperlink{classObjectStorage_ad287a079892332b3a6d71b10275b925f}{Object\+Storage}}.

\Hypertarget{classMockObjectStorage_a0d17e41ae6b3787ed45aad9b75ea0518}\index{MockObjectStorage@{MockObjectStorage}!saveObject@{saveObject}}
\index{saveObject@{saveObject}!MockObjectStorage@{MockObjectStorage}}
\doxysubsubsection{\texorpdfstring{saveObject()}{saveObject()}}
{\footnotesize\ttfamily \label{classMockObjectStorage_a0d17e41ae6b3787ed45aad9b75ea0518} 
bool Mock\+Object\+Storage\+::save\+Object (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classVcsObject}{Vcs\+Object}} \&}]{obj}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Сохраняет \doxylink{classVcsObject}{Vcs\+Object} в базе данных объектов. 

Сериализует объект, добавляет заголовок, сжимает его и записывает в файл. Публикует события об успехе/неудаче. 
\begin{DoxyParams}{Аргументы}
{\em obj} & \doxylink{classVcsObject}{Vcs\+Object} для сохранения. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Возвращает}
bool True, если сохранение прошло успешно. 
\end{DoxyReturn}

\begin{DoxyExceptions}{Исключения}
{\em std\+::runtime\+\_\+error} & если хеш недействителен или операции ввода-\/вывода завершаются неудачно. \\
\hline
\end{DoxyExceptions}


Переопределяет метод предка \mbox{\hyperlink{classObjectStorage_acab6226c60b2979078001d539f56de3b}{Object\+Storage}}.



Объявления и описания членов класса находятся в файле\+:\begin{DoxyCompactItemize}
\item 
tests/core/\mbox{\hyperlink{IndexTest_8cxx}{Index\+Test.\+cxx}}\end{DoxyCompactItemize}
